#!/bin/bash

# Wait for the Wayland display socket to appear

SOCKET="${XDG_RUNTIME_DIR}/${WAYLAND_DISPLAY:-wayland-0}"
TIMEOUT_SECS=10
SLEEP_MS=200
MAX_TRIES=$(( TIMEOUT_SECS * 1000 / SLEEP_MS ))

for ((i = 0; i < MAX_TRIES; i++)); do
  if [[ -S "$SOCKET" ]]; then
    exit 0
  fi
  sleep 0.2
done

echo "[wait-for-hyprland] Socket '$SOCKET' not available after ${TIMEOUT_SECS}s" >&2
exit 1
